# ALIKE: Accurate and Lightweight Keypoint Detection and Descriptor Extraction

## 論文について (掲載ジャーナルなど)
- [Zhao, X., Wu, X., Miao, J., Chen, W.,  Chen, P. C., & Li, Z. (2022). ALIKE: Accurate and Lightweight  Keypoint Detection and Descriptor Extraction. *IEEE Transactions on Multimedia*.](https://arxiv.org/abs/2112.02906)

## 概要
- 最先端のアプローチと同等の性能かつ推論速度が爆速のキーポイント抽出ニューラルネットワークを提案
    - 商用GPUで$640\times480$画像に対して95フレーム/秒で動作可能

- 技術ポイント
    - 正確なサブピクセルキーポイントを出力する、部分的に微分可能なキーポイント検出モジュールを提案
    - サブピクセルキーポイントを直接最適化するための再投影損失を提案し、正則化のための分散性ピーク損失を提案
    - Descriptor をサブピクセル単位で抽出し、安定なニューラル再投影誤差損失を用いて学習


## 問題設定と解決したこと
- 疎なキーポイントやディスクリプタは、効率的な画像マッチングのためのコンパクトな表現
    - 往年の方法は人間のヒューリスティックに基づいて構築されており、複雑な画像では不安定なキーポイントやマッチングしずらいディスクリプタにつながって不安定

- 不安定な表現を改善するために、近年ニューラルネットワークを用いた手法が研究されている
    - キーポイントの検出とディスクリプタの抽出を一つのネットワークでできるようになった
        - [感想]ここらへん全然わからんな。TODO:[12]-[15]あたりの論文ちらっと見るべし

    - キーポイント検出をスコアマップ推定問題として扱う方法が多い
        - ある画素のスコアがそれがキーポイントである確率を表す方法

    - スコアマップを推定する方法は、最後にはスコアマップ上のキーポイントをNMSにより検出する必要がある
        - NMSは微分不可能なので、誤差の逆伝播ができない→**キーポイントを直接最適化することができない**

- 上の問題を解決するために、局所的に微分可能なキーポイント検知手法を提案することで、キーポイントを直接最適化できるようになり、精度向上
- あと既存の方法は動作速度よりもマッチング性能に重点が置かれている
    - 応用考えたら軽量であることが求められるよね（ロボットのSLAM用とか）
    - ネットワークが軽量であることも重視したよ

- 本論文のコントリビューション
    1.  微分可能なキーポイント検出モジュールと、正確で再現性のあるキーポイント学習のための再投影誤差と分散ピークロスを提案
    2.  NRE (Neural Reprojection Error [29]) 損失を用いて、密なディスクリプタマップを学習することにより、安定的にモデルを収束
    3.  効率的なキーポイント検出とディスクリプタ抽出のために、階層的な特徴を集約した軽量なネットワークを設計し、商用GPU上で95 FPSで動作


## 何をどう使ったのか
- スコアマップに基づくキーポイント検出とディスクリプタ抽出のための微分可能キーポイント検知（DKD）を提案
    - NMS (Non-Maximum-Suprression) ベースの手法と比較して、勾配を逆伝播し、サブピクセル精度のキーポイントを生成することが可能
    - 以上により、検出されたキーポイントの位置を直接的に最適化し、精度を高めることができる
    - <img src="picture/Screenshot from 2023-01-25 23-05-36.png" alt="Screenshot from 2023-01-25 23-05-36" style="zoom:80%;" />
- 軽量なネットワークを設計
    - <img src="picture/Screenshot from 2023-01-25 23-29-02.png" alt="Screenshot from 2023-01-25 23-29-02" style="zoom: 50%;" />
- ネットワークアーキテクチャ
    - 概要は図2をみてね
    - 次の4パートに分けられる
        - (a)画像特徴量エンコーダ
            - 入力画像を特徴マップに符号化

        - (b)特徴集約モジュール
            - それぞれの層から抽出された特徴を集約
            - $1\times1$ 畳み込みとバイリニアアップサンプリングにより、特徴マップの大きさを合わせて単純に連結

        - (c)特徴抽出部
            - 集約した特徴からディスクリプタマップ$D$とスコアマップ$S$をこねこねして作る

        - (d)微分可能キーポイント検出とディスクリプタサンプリング
            - DKDを使って$S$からサブピクセルキーポイント検出
            - キーポイントのディスクリプタを$D$からサンプル抽出



## 主張の有効性の検証方法
- いろいろなデータ・セットで検証
- 計算量くっっそすくない！なのに既存手法とだいたい同じ精度！やったね！

## 批評
- 

## 関連研究

-   ディープラーニングを用いたキーポイント検出の手法は次の3つに大別される
    1.  パッチベースの手法
        -   代表的なやり方は、Matchnet。画像パッチからディスクリプタ抽出→ディスクリプタの類似性を推定しクロスエントロピー損失で学習
        -   ディスクリプタに対して、トリプレットロスを導入する手法TFeatもある
    2.  スコアマップベースの手法
        -   スコアマップとディスクリプタマップを推定。スコアマップはキーポイントの確率を表す。
            -   Tilde, LFNet, MLIFeat, R2D2 など
    3.  ディスクリプタ＆検知手法
        -   キーポイントを画像中の特徴的な位置として認識し、ディスクリプタマップまたは特徴マップの特徴量を計算してスコアマップを生成
            -   D2Net, ASLFeat, D2D など

## 次に読むべき論文
- 
