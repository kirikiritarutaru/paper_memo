# Neural Reprojection Error: Merging Feature Learning and Camera Pose Estimation

## 論文について (掲載ジャーナルなど)
- [Germain, H., Lepetit, V., & Bourmaud, G. (2021). Neural reprojection error: Merging feature learning and camera pose estimation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (pp. 414-423).](https://arxiv.org/abs/2103.07153)

## 概要
- 絶対カメラポーズ推定は通常次の2つのサブ問題を解くことで解く
  - 2D-3D対応の推定を行う特徴マッチング問題
  - カメラポーズに関して、再投影誤差の和を最小化するPnP問題
- 本論文では、再投影誤差に代わるものとして、ニューラル・リプロジェクション・エラー（NRE）を提案
  - NREの再投影誤差よりも良いポイント
    - 2D-3D対応よりも豊富な情報を活用できる
    - ロバストな損失
    - ハイパーパラメータ選択をなくせる
- NRE項の和を効率的に最小化する最適化手法も提案
- 計算効率とメモリ効率を高めたまま、カメラ姿勢推定のロバスト性と精度の両方を改善

## 問題設定と解決したこと
- 問題：
  - 絶対カメラ姿勢推定は、特徴マッチング問題とPnP問題という2つの別々の問題を順番に解くことで解かれる
  - しかしながら、2D-3D対応を生成することで情報の損失が大きくなり、対応の外れ値が誤ったデータを姿勢推定器に伝え、再投影誤差が大きくなることで、精度が低くなるという課題がある。
- 解決策：
  - 再投影誤差の代わりに、**Neural Reprojection Error (NRE)** を提案
    - 2D-3D対応の代わりに密な損失マップを使う
    - 情報が多いので、姿勢推定器により高品質のデータを提供できる
  - NREを導入するご利益
    - 特徴マッチング問題と姿勢推定問題の統合
      - NREはカメラ姿勢に関してだけでなく、ディスクリプタに関しても微分可能で、姿勢推定に最適化された特徴マッチングの学習ができる
  - そんなこと言っても、NREを導入すると計算量が多くなって使いにくいんじゃないの？
    - **そうじゃありません！**
    - 計算のときにNRE項の粒度を、粗い→細かいに段階的に最小化することで、少ない計算で高精度な特徴マッチング＋姿勢推定ができます！

## 何をどう使ったのか
- NRE
- NRE項の最小化

## 主張の有効性の検証方法
- 結果：
  - 実験の結果、NREを導入することにより、姿勢推定のロバスト性と精度を大幅に向上させ、計算効率とメモリ効率も高いことがわかった

## 批評
-

### ChatGPTによるまとめ

>   この論文は、カメラポーズ推定問題に対して新たなアプローチを提案しています。そのアプローチは、特徴学習問題とカメラポーズ推定問題を統合することで、より豊かな情報を活用し、ロバストなロスとそのハイパーパラメーターの選択を不要にする「Neural Reprojection Error (NRE)」という手法です。
>
>   以下に要点をまとめます。
>
>   1. **どんなもの？**
>       - この論文は、「Neural Reprojection Error (NRE)」という新しい手法を提案しています。これはカメラポーズ推定と特徴学習問題を統合し、より豊かな情報を活用することで、ロバストなロスとそのハイパーパラメーターの選択を不要にします。また、NREは、ポーズ推定に特化した画像記述子を学習するためのトレーニングロスとして使用できます。
>
>   2. **先行研究と比べてどこがすごい？**
>       - 伝統的にカメラポーズ推定は、特徴マッチング問題とPerspective-n-Point問題の二つのサブ問題に分けられて解かれてきました。しかし、この分離は情報損失を引き起こし、ロバストなロスとそのハイパーパラメーターの選択を必要としてきました。これに対し、NREはこれらの問題を統合し、情報損失を軽減し、ロバストなロスとそのハイパーパラメーターの選択を不要にします。
>
>   3. **技術や手法の重要な部分はどこ？**
>       - NREは、2D-3D対応関係を必要とせず、代わりに、特に曖昧で多モーダルなケースでREよりも多くの情報を含む密な損失マップを使用します。これにより、ポーズ推定器はNREを使用してREよりも大幅に正確でロバストになります。
>
>   4. **どうやって有効だと検証した？**
>       - 著者らは、カメラポーズの推定におけるNREの効果を実験的に示しました。その結果、NREはカメラポーズ推定の精度と頑健性を大幅に向上させることができることを実証しました。
>
>   5. **議論はある？**
>       - 論文中では、NREがカメラポーズ推定の問題だけでなく、他のコンピュータビジョンアプリケーションでも有用である可能性を示唆しています。
>
>   6. **次に読むべき論文は？**
>       - この手法が他のコンピュータビジョンの問題にどのように適用できるかを探るために、NREを使用した他の研究を読むと良いでしょう。また、特徴マッチング問題とカメラポーズ推定問題の統合について深く理解するために、これらの問題を独立して解く従来の手法についての論文を読むことも有益でしょう。
>
>   
>
>   「多モーダルな状況」とはどんな状況？
>
>   「多モーダルな状況」は、データが複数の異なる分布または「モード」を示す状況を指します。この文脈では、「多モーダル」は一つの3D点が複数の異なる2D位置に対応可能である、という状況を指しています。これは、たとえば、画像内の複数の位置が外観が非常に似ている場合、または画像中の物体が繰り返しパターンを示している場合などに発生します。
>
>   このような状況では、一つの3D点を2D画像に投影した結果が、複数の異なる「正しい」位置になり得ます。従来のReprojection Error（RE）は一つの2D-3D対応関係を前提としていますので、多モーダルな状況を適切に取り扱うことができません。しかし、Neural Reprojection Error（NRE）は2D-3D対応を前提とせず、損失マップを使用するため、これらの状況をより適切に処理できます。

## 次に読むべき論文
-
