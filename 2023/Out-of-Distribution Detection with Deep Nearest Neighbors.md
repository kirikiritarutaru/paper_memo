# Out-of-Distribution Detection with Deep Nearest Neighbors

## 論文について (掲載ジャーナルなど)
- https://arxiv.org/pdf/2204.06507.pdf

## 概要
- 分布外検出（OOD detection）は重要なタスク
- 既存手法は、基礎となる特徴空間に強い分布の仮定をおいており、現実の問題では必ずしも成立しない可能性がある
- 本論文では、OOD検出におけるノンパラメトリック最近傍距離の有効性を探る
    - 分布に仮定を置かないので、高い柔軟性と一般性が期待できる

- 精度を確認したら、既存手法と比較して大幅に良くなった

### ChatGPTによるまとめ

>   この論文は、深層学習モデルのオープンワールド展開における重要な課題である外分布検出（Out-of-Distribution Detection, OOD）について取り組んでいます。この論文では、非パラメトリックな近傍距離を用いた新たなOOD検出手法を提案し、その効果を実証しています。
>
>   以下に、要点を詳細にまとめます。
>
>   1. **どんなもの？**
>       - 著者らは、ディープラーニングモデルの特徴埋め込み空間における非パラメトリックな最近傍距離を用いた新しいOOD検出手法を提案しています。この手法は、分布の仮定を必要とせず、分布がガウスでない場合でも使用できます。提案手法は、テスト入力の埋め込みとトレーニングセットの埋め込み間のk番目の最近傍（KNN）距離を計算し、閾値に基づいて入力がOODか否かを判断します。
>
>   2. **先行研究と比べてどこがすごい？**
>       - 従来の距離ベースのOOD検出手法は、特徴埋め込み空間がクラス条件付きのガウス分布であるという強い仮定を必要としていました。これに対して、提案手法は非パラメトリックであり、分布の仮定を必要としません。そのため、提案手法はより柔軟で一般的な状況に対応できます。
>
>   3. **技術や手法の重要な部分はどこ？**
>       - 提案手法の核心は、特徴埋め込み空間における非パラメトリックな最近傍距離を用いることです。この手法は、分布の仮定を必要とせず、ディープk最近傍距離に基づいてデータを2つのセット（ID vs. OOD）に分割します。これにより、データがどのような分布を持つかにかかわらず、入力がID（分布内）かOOD（分布外）かを効果的に判定できます。
>
>   4. **どうやって有効だと検証した？**
>       - 著者らは、提案手法をいくつかのベンチマークデータセットに適用し、その効果を評価しました。その結果、提案手法は、既存のパラメトリック手法（マハラノビス距離を使用するSSD+）と比較して、偽陽性率（FPR@TPR95）を24.77%減少させることができました。
>
>   5. **議論はある？**
>       - 提案手法は、非パラメトリックな最近傍距離を用いてOOD検出を行う初の研究です。そのため、この手法の有効性と限界をさらに探るための議論と研究が必要です。また、最近傍距離を用いるこのアプローチが他の問題に対してどのように適用できるかも未解明です。
>
>   6. **次に読むべき論文は？**
>       - 非パラメトリックな最近傍距離を用いたOOD検出についてさらに理解を深めるためには、最近傍法や近傍距離に基づく他の検出手法に関する論文を読むことが有益でしょう。また、特徴埋め込み空間の分布についての理解を深めるためには、特徴埋め込みや特徴空間に関する論文も参考になります。
>
>   
>
>   「ディープk最近傍距離」がわかりません。詳しく1ステップずつ解説してください。
>
>   "ディープk最近傍距離"とは、深層学習モデルが生成する特徴空間におけるk最近傍法（k-nearest neighbors, k-NN）を指します。以下に、その手順を1ステップずつ解説します。
>
>   1. **特徴抽出**：最初に、深層学習モデル（通常はニューラルネットワーク）を用いて、データから特徴を抽出します。具体的には、モデルは各データポイント（例えば画像）を高次元の特徴ベクトルに変換します。この変換は、データポイントの重要な情報やパターンをキャプチャします。
>
>   2. **特徴空間における距離の計算**：次に、この特徴空間（つまり、特徴ベクトルが存在する空間）において、あるデータポイントの特徴ベクトルと最も近いk個の特徴ベクトルとの距離を計算します。距離の計算には、通常はユークリッド距離やコサイン距離などが用いられます。
>
>   3. **k最近傍距離の決定**：計算された距離の中から、最も近いk個の距離を選びます。これらの距離が「ディープk最近傍距離」です。
>
>   この「ディープk最近傍距離」は、新たなデータポイントが既知のデータ集合からどれだけ離れているか（つまり、それが「外れ値」や「異常」である可能性があるか）を評価するのに役立ちます。特に、この論文では、この距離が「分布外（Out-of-Distribution）」のデータを検出するための指標として用いられています。

## 問題設定と解決したこと
- 

## 何をどう使ったのか
- 

## 主張の有効性の検証方法
- 

## 批評
- 

## 次に読むべき論文
- 
