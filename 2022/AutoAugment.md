# AutoAugment:Learning Augmentation Strategies from Data

## 論文について (掲載ジャーナルなど)
- [Cubuk, E. D., Zoph, B., Mane, D.,  Vasudevan, V., & Le, Q. V. (2019). Autoaugment: Learning  augmentation strategies from data. In *Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition* (pp. 113-123).](https://arxiv.org/pdf/1805.09501.pdf)

## 概要
- データオーグメンテーションの方針を自動的に探索するシンプルな手順
- データオーグメンテーションのポリシーは多数のサブポリシーから構成される
    - 画像処理関数：並進、回転、せん断
    - 画像処理関数を適用する確率と、画像処理関数の強さ

- 複数データ・セットでSOTA(2019年時)

## 問題設定と解決したこと
- データオーグメンテーションは画像分類器の精度向上に効くけど、人手でやるのメンドイ
- 方針決めて、自動化しました

## 何をどう使ったのか
- データの拡張方針を見つける問題の解法
    - 探索アルゴリズム
        - 強化学習で探索
            - リカレントニュラルネットワークによるコントローラとPPOアルゴリズムによる学習アルゴリズム
                - 各ステップで、コントローラはソフトマックスによって生成される決定を予測
                - 予測を次のステップにエンベッディングとして供給

            - 5つのサブポリシーを予測するため、合計で30個のソフトマックスの予測をもつ（それぞれ2つの操作、各操作の種類、大きさ、確率）

        - 画像処理操作、各バッチでその操作を使用する確率、操作の大きさに関する情報をもつデータ拡張方針$S$をサンプリング

    - 探索空間
        - 1つのポリシーは5つのサブポリシーで構成
        - 各サブポリシーは順番に適用される2つの画像処理操作で構成
            - ShearX／Y、TranslateX／Y、Rotate、AutoContrast、Invert、Equalize、Solarize、Posterize、Contrast、Color、Brightness、Sharpness、Cutout [12], Sample Pairing [24]の合計16個
            - 操作の大きさを10パターン、操作の適用確率11パターン
            - 操作を順番に2つ選択し5つのサブポリシーを見つけることを目標（←これで10乗）
            - したがって、探索空間の広さ：$(16\times10\times11)^{10}\approx2.9\times10^{32}$


## 主張の有効性の検証方法
- CIFAR-10、CIFAR-100、SVHN、ImageNetで調べたらSOTAだった
    - 精度 83.1%→83.5% @ImageNet
    - 誤り率 2.1%→1.5% @CIFAR-10

- 増強方針はデータセット間で移行が可能

## 批評
- [torchvisionのautoaugment](http://pytorch.org/vision/main/generated/torchvision.transforms.AutoAugment.html)の項目を見て、読もうと思った
- この論文すごいあやしい
    - 怪しい点
        - ランダムにデータ拡張したときと大きな差があるのか？
            - 画像処理操作を2つをランダムで選んだ時との差ってないんじゃないか

        - モデルとデータセットの組み合わせにはちゃめちゃに過剰適合してるだけなのでは？
            - RNNとPPOでうまくいくのか？

        - データセットの特性を無視して、盲目的にデータ拡張かけてるんじゃないか？
            - フリップが駄目なケースとかあるし
                - 例えば、クジラの背びれからIDを当てるタスク：背びれの傷が固有になるので左右フリップすると別個体としてカウントするほうが自然になる

        - ハイパー計算機で探しましたはい終わり感
            - データ拡張の強さをエポックが進むごとに徐々に強くしていくとか、画像が大きい場合は強くかけたほうがいいとか仮説を持って、それを検証してほうがよいのでは

- 残念だ

## 次に読むべき論文
- 
